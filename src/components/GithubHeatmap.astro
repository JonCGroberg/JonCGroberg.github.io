---
const username = "joncgroberg";
interface Contribution {
    date: string;
    count: number;
    color: string;
    intensity: number;
}
interface Year {
    year: number;
    total: number;
    range: string;
    contributions: Contribution[];
}

const response = await fetch(
    "https://github-contributions.vercel.app/api/v1/joncgroberg",
);
const {
    years,
    contributions,
}: { years: Year[]; contributions: Contribution[] } = await response.json();
const currentYear = years[0];
const contributionsLast12Months = contributions.slice(0, 367).reverse();

function generateColor(intensity: number) {
    if (intensity < 1) {
        return "#ebedf0";
    } else if (intensity == 1) {
        return "limegreen";
    } else if (intensity == 2) {
        return "lightgreen";
    } else if (intensity == 3) {
        return "green";
    } else {
        return "darkgreen";
    }
}
---

<div class="flex flex-wrap w-full">
    <div class="w-full text-center">
        {currentYear.total} Contributions in {currentYear.year}
    </div>
    <div class="overflow-x-auto py-1 mx-auto">
        <div
            class="grid grid-rows-7 grid-flow-col gap-[2px] w-full hover:*:outline *:hover:outline-green-400"
        >
            {
                contributionsLast12Months.map((contribution: Contribution) => (
                    <div
                        class:list={[`p-[5px] rounded-sm`]}
                        style={{
                            backgroundColor: generateColor(
                                contribution.intensity,
                            ),
                        }}
                        data-tooltip={contribution.intensity}
                        data-data={contribution.date}
                    />
                ))
            }
        </div>
    </div>

    <script></script>
</div>
